<div class="logo-editor-container">
  <!-- Left Icon Sidebar -->
  <div class="icon-sidebar">
    <div class="icon-nav">
      <button
        class="nav-icon-btn"
        [class.active]="activeTab === 'brand'"
        (click)="setActiveTab('brand')"
        title="Brand Name"
      >
        <img src="../../../../../assets/icons/name.svg" alt="NS_Logo" />
      </button>

      <button
        class="nav-icon-btn"
        [class.active]="activeTab === 'slogan'"
        (click)="setActiveTab('slogan')"
        title="Slogan"
      >
        <img src="../../../../../assets/icons/slogan.svg" alt="NS_Logo" />
      </button>

      <button class="nav-icon-btn" [class.active]="activeTab === 'icons'" (click)="setActiveTab('icons')" title="Icons">
        <img src="../../../../../assets/icons/icon.svg" alt="NS_Logo" />
      </button>

      <button
        class="nav-icon-btn"
        [class.active]="activeTab === 'shapes'"
        (click)="setActiveTab('shapes')"
        title="Shapes"
      >
        <img src="../../../../../assets/icons/shape.svg" alt="NS_Logo" />
      </button>

      <button
        class="nav-icon-btn"
        [class.active]="activeTab === 'colors'"
        (click)="setActiveTab('colors')"
        title="Colors"
      >
        <img src="../../../../../assets/icons/color.svg" alt="NS_Logo" />
      </button>
    </div>
  </div>

  <!-- Middle Panel - Editor Controls -->
  <div class="editor-panel">
    <!-- Brand Name Section -->
    <div class="editor-section brand-section" *ngIf="activeTab === 'brand'">
      <div class="logo-container">
        <img src="../../../../../assets/icons/NS_Logo.svg" alt="NS_Logo" />
      </div>
      <div class="section-header">
        <h2>Make your name shine</h2>
        <p class="section-description">A few small tweaks can help your logo feel just right and totally on brand.</p>
      </div>

      <div class="form-group">
        <label class="form-label">Brand Name</label>
        <input
          *ngIf="!isMultiline"
          type="text"
          class="form-input"
          [(ngModel)]="brandName"
          (ngModelChange)="onBrandNameChange()"
          placeholder="Enter your brand name"
        />
        <textarea
          *ngIf="isMultiline"
          class="form-input multiline-input"
          [(ngModel)]="brandName"
          (ngModelChange)="onBrandNameChange()"
          placeholder="Enter your brand name (use Enter for new lines)"
          rows="3"
        ></textarea>
      </div>

      <div class="fonts-section">
        <h3 class="subsection-title">Recommended Fonts</h3>
        <div class="fonts-grid">
          <button
            *ngFor="let font of getDisplayFonts()"
            class="font-tile"
            [class.active]="selectedFont === font.name"
            (click)="selectFont(font.name)"
            [style.font-family]="font.family"
          >
            {{ font.display }}
          </button>
        </div>
      </div>

      <div class="custom-font-section">
        <h3 class="subsection-title">Custom Font</h3>
        <div class="upload-dropdown-container">
          <button class="upload-btn" (click)="toggleUploadDropdown()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
            </svg>
            Upload your own fonts
            <svg
              width="12"
              height="12"
              viewBox="0 0 24 24"
              fill="currentColor"
              [style.transform]="showUploadDropdown ? 'rotate(180deg)' : 'rotate(0deg)'"
            >
              <path d="M7,10L12,15L17,10H7Z" />
            </svg>
          </button>

          <!-- Upload Dropdown -->
          <div class="upload-dropdown" *ngIf="showUploadDropdown">
            <div class="upload-zone">
              <input
                type="file"
                id="font-upload"
                (change)="onFileUpload($event)"
                accept=".ttf,.otf,.woff,.woff2"
                style="display: none"
              />
              <label for="font-upload" class="upload-label">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
                </svg>
                <span>Choose font file</span>
                <small>TTF, OTF, WOFF, WOFF2</small>
              </label>
            </div>

            <!-- Uploaded Fonts List -->
            <div class="uploaded-fonts" *ngIf="uploadedFonts.length > 0">
              <div class="uploaded-font-item" *ngFor="let font of uploadedFonts" (click)="selectUploadedFont(font)">
                <span class="font-name" [style.font-family]="font.family">{{ font.name }}</span>
              </div>
            </div>

            <!-- Font Formatting Controls -->
            <div class="font-formatting" *ngIf="uploadedFonts.length > 0 || selectedFont !== 'Arial'">
              <div class="formatting-label">Text Style</div>
              <div class="formatting-buttons">
                <button class="format-btn" [class.active]="isBold" (click)="toggleBold()" title="Bold">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M13.5,15.5H10V12.5H13.5A1.5,1.5 0 0,1 15,14A1.5,1.5 0 0,1 13.5,15.5M10,6.5H13A1.5,1.5 0 0,1 14.5,8A1.5,1.5 0 0,1 13,9.5H10M15.6,10.79C16.57,10.11 17.25,9.02 17.25,8C17.25,5.74 15.5,4 13.25,4H7V18H14.04C16.14,18 17.75,16.3 17.75,14.21C17.75,12.69 16.89,11.39 15.6,10.79Z"
                    />
                  </svg>
                </button>
                <button class="format-btn" [class.active]="isItalic" (click)="toggleItalic()" title="Italic">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10,4V7H12.21L8.79,15H6V18H14V15H11.79L15.21,7H18V4H10Z" />
                  </svg>
                </button>
              </div>
            </div>

            <div class="upload-loading" *ngIf="isUploadingFont">
              <div class="loading-spinner"></div>
              <span>Uploading font...</span>
            </div>
          </div>
        </div>
      </div>

      <div class="controls-section">
        <div class="control-row">
          <div class="control-group multiline-control">
            <label class="control-label">Multiline</label>
            <div class="toggle-switch">
              <input type="checkbox" id="multiline" [(ngModel)]="isMultiline" (ngModelChange)="onMultilineToggle()" />
              <label for="multiline" class="toggle-slider"></label>
            </div>
          </div>
          <div class="control-helper">
            <small class="helper-text">
              {{ isMultiline ? 'Text will display on multiple lines' : 'Text will display on a single line' }}
            </small>
          </div>
        </div>

        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Font Size</label>
            <div class="slider-wrapper">
              <input
                type="range"
                class="range-slider"
                [(ngModel)]="fontSize"
                (ngModelChange)="onFontSizeChange()"
                min="12"
                max="72"
              />
            </div>
          </div>
        </div>

        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Letter Spacing</label>
            <div class="slider-wrapper">
              <input
                type="range"
                class="range-slider"
                [(ngModel)]="letterSpacing"
                (ngModelChange)="onLetterSpacingChange()"
                min="-2"
                max="10"
              />
            </div>
          </div>
        </div>

        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Line Height</label>
            <div class="slider-wrapper">
              <input
                type="range"
                class="range-slider"
                [(ngModel)]="lineHeight"
                (ngModelChange)="onLineHeightChange()"
                min="0.8"
                max="2"
                step="0.1"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slogan Section -->
    <div class="editor-section" *ngIf="activeTab === 'slogan'">
      <div class="section-header">
        <h2>Bring your slogan to life</h2>
        <p class="section-description">Tweek few logos to match your brand perception</p>
      </div>

      <!-- Slogan Toggle -->
      <div class="form-group">
        <label class="form-label">Slogan Text</label>
        <div class="slogan-toggle-container">
          <div class="toggle-group">
            <label class="toggle-label">Custom Designer Toys</label>
            <div class="toggle-switch">
              <input type="checkbox" id="sloganToggle" [(ngModel)]="enableSlogan" (ngModelChange)="onSloganToggle()">
              <label for="sloganToggle" class="toggle-slider"></label>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Slogan Text Input -->
      <div class="form-group" *ngIf="enableSlogan">
        <input
          *ngIf="!sloganIsMultiline"
          type="text"
          class="form-input"
          [(ngModel)]="sloganText"
          (ngModelChange)="onSloganChange()"
          placeholder="Enter your slogan"
        />
        <textarea 
          *ngIf="sloganIsMultiline"
          class="form-input multiline-input" 
          [(ngModel)]="sloganText" 
          (ngModelChange)="onSloganChange()" 
          placeholder="Enter your slogan (use Enter for new lines)"
          rows="3"
        ></textarea>
      </div>
      
      <!-- Recommended Fonts -->
      <div class="fonts-section" *ngIf="enableSlogan">
        <h3 class="subsection-title">Recommended Fonts</h3>
        <div class="fonts-grid">
          <button 
            *ngFor="let font of getDisplayFonts()" 
            class="font-tile"
            [class.active]="sloganFont === font.name"
            (click)="selectSloganFont(font.name)"
            [style.font-family]="font.family"
          >
            {{ font.display }}
          </button>
        </div>
      </div>
      
      <!-- Custom Font Upload -->
      <div class="custom-font-section" *ngIf="enableSlogan">
        <h3 class="subsection-title">Custom Font</h3>
        <div class="upload-dropdown-container">
          <button class="upload-btn" (click)="toggleUploadDropdown()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
            </svg>
            Upload your own fonts
            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" 
                 [style.transform]="showUploadDropdown ? 'rotate(180deg)' : 'rotate(0deg)'">
              <path d="M7,10L12,15L17,10H7Z" />
            </svg>
          </button>
          
          <!-- Font Formatting Controls for Slogan -->
          <div class="font-formatting-inline" *ngIf="enableSlogan">
            <div class="formatting-buttons">
              <button class="format-btn" 
                      [class.active]="sloganIsBold" 
                      (click)="toggleSloganBold()"
                      title="Bold">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M13.5,15.5H10V12.5H13.5A1.5,1.5 0 0,1 15,14A1.5,1.5 0 0,1 13.5,15.5M10,6.5H13A1.5,1.5 0 0,1 14.5,8A1.5,1.5 0 0,1 13,9.5H10M15.6,10.79C16.57,10.11 17.25,9.02 17.25,8C17.25,5.74 15.5,4 13.25,4H7V18H14.04C16.14,18 17.75,16.3 17.75,14.21C17.75,12.69 16.89,11.39 15.6,10.79Z" />
                </svg>
              </button>
              <button class="format-btn" 
                      [class.active]="sloganIsItalic" 
                      (click)="toggleSloganItalic()"
                      title="Italic">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M10,4V7H12.21L8.79,15H6V18H14V15H11.79L15.21,7H18V4H10Z" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Alignment -->
      <div class="text-alignment" *ngIf="enableSlogan">
        <h3 class="subsection-title">Alignment</h3>
        <div class="alignment-buttons">
          <button class="align-btn" [class.active]="textAlignment === 'left'" (click)="setAlignment('left')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3,3H21V5H3V3M3,7H15V9H3V7M3,11H21V13H3V11M3,15H15V17H3V15M3,19H21V21H3V19Z" />
            </svg>
          </button>
          <button class="align-btn" [class.active]="textAlignment === 'center'" (click)="setAlignment('center')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3,3H21V5H3V3M7,7H17V9H7V7M3,11H21V13H3V11M7,15H17V17H7V15M3,19H21V21H3V19Z" />
            </svg>
          </button>
          <button class="align-btn" [class.active]="textAlignment === 'right'" (click)="setAlignment('right')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3,3H21V5H3V3M9,7H21V9H9V7M3,11H21V13H3V11M9,15H21V17H9V15M3,19H21V21H3V19Z" />
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Line Count -->
      <div class="line-count-section" *ngIf="enableSlogan">
        <h3 class="subsection-title">Line Count</h3>
        <div class="line-count-selector">
          <select class="line-count-dropdown" [(ngModel)]="sloganLineCount" (ngModelChange)="onSloganLineCountChange()">
            <option value="1">1 Line</option>
            <option value="2">2 Lines</option>
            <option value="3">3 Lines</option>
            <option value="4">4 Lines</option>
          </select>
        </div>
      </div>
      
      <!-- Controls Section -->
      <div class="controls-section" *ngIf="enableSlogan">
        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Font Size</label>
            <div class="slider-wrapper">
              <input 
                type="range" 
                class="range-slider"
                [(ngModel)]="sloganFontSize" 
                (ngModelChange)="onSloganFontSizeChange()" 
                min="10" 
                max="48"
              >
            </div>
          </div>
        </div>
        
        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Letter Spacing</label>
            <div class="slider-wrapper">
              <input 
                type="range" 
                class="range-slider"
                [(ngModel)]="sloganLetterSpacing" 
                (ngModelChange)="onSloganLetterSpacingChange()" 
                min="-2" 
                max="10"
              >
            </div>
          </div>
        </div>
        
        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Line Height</label>
            <div class="slider-wrapper">
              <input 
                type="range" 
                class="range-slider"
                [(ngModel)]="sloganLineHeight" 
                (ngModelChange)="onSloganLineHeightChange()" 
                min="0.8" 
                max="2" 
                step="0.1"
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Icons Section -->
    <div class="editor-section" *ngIf="activeTab === 'icons'">
      <div class="section-header">
        <h2>Make your mark</h2>
        <p class="section-description">Choose an icon that represents your brand.</p>
      </div>

      <div class="icon-grid">
        <button
          *ngFor="let icon of availableIcons.slice(0, 9)"
          class="icon-option"
          [class.active]="selectedIcon?.name === icon.name"
          (click)="selectIcon(icon)"
        >
          <div class="icon-placeholder">
            {{ icon.name.charAt(0) }}
          </div>
          <span class="icon-name">{{ icon.name }}</span>
        </button>
      </div>

      <div class="icon-controls" *ngIf="selectedIcon">
        <div class="control-row">
          <div class="control-group">
            <label class="control-label">Size</label>
            <div class="slider-wrapper">
              <input
                type="range"
                class="range-slider"
                [(ngModel)]="iconSize"
                (ngModelChange)="onIconSizeChange()"
                min="16"
                max="128"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Shapes Section -->
    <div class="editor-section" *ngIf="activeTab === 'shapes'">
      <div class="section-header">
        <h2>Frame your logo</h2>
        <p class="section-description">Add a shape to frame your design.</p>
      </div>

      <div class="shapes-grid">
        <button
          *ngFor="let shape of shapes"
          class="shape-option"
          [class.active]="selectedShape?.name === shape.name"
          (click)="selectShape(shape)"
        >
          <div class="shape-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path
                *ngIf="shape.name === 'Circle'"
                d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
              />
              <path *ngIf="shape.name === 'Square'" d="M3,3V21H21V3H3M5,5H19V19H5V5Z" />
              <path *ngIf="shape.name === 'Triangle'" d="M12,2L22,20H2L12,2Z" />
            </svg>
          </div>
          <span class="shape-name">{{ shape.name }}</span>
        </button>
      </div>
    </div>

    <!-- Colors Section -->
    <div class="editor-section" *ngIf="activeTab === 'colors'">
      <div class="section-header">
        <h2>Define your brand's tone</h2>
        <p class="section-description">Choose colors that reflect your brand personality.</p>
      </div>

      <div class="color-palettes">
        <div class="palette-row" *ngFor="let palette of colorPalettes">
          <div
            *ngFor="let color of palette"
            class="color-swatch"
            [style.backgroundColor]="color"
            [class.active]="customColor === color"
            (click)="selectColor(color)"
          ></div>
        </div>
      </div>

      <div class="custom-color-section">
        <label class="form-label">Custom Color</label>
        <input type="color" class="color-input" [(ngModel)]="customColor" (ngModelChange)="onCustomColorChange()" />
      </div>
    </div>
  </div>

  <!-- Right Panel - Logo Preview -->
  <div class="preview-panel">
    <div class="preview-header">
      <div class="preview-actions">
        <button class="action-btn secondary" (click)="undo()" [disabled]="!canUndo">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"
            />
          </svg>
        </button>
        <button class="action-btn secondary" (click)="redo()" [disabled]="!canRedo">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.53,15.22L3.9,16C4.95,12.81 7.96,10.5 11.5,10.5C13.46,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"
            />
          </svg>
        </button>
      </div>
      <div class="preview-buttons">
        <button class="action-btn primary download-btn" (click)="downloadLogo()" title="Download logo pack with PNG, SVG and JPG formats">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
          </svg>
          Download Pack
        </button>
        <button class="action-btn primary publish-btn" (click)="publishLogo()">Publish</button>
      </div>
    </div>
    <div class="preview-content">
      <div class="logo-canvas-wrapper">
        <canvas #logoCanvas class="logo-canvas"></canvas>
      </div>
    </div>
  </div>
</div>
